ylab("Relative expression (/rpL32)") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "#888888"))+
ggtitle("Effect of pyriproxyfen on prepupae") +
scale_y_continuous(breaks=seq(0,2,by = 0.1)) +
theme_bw()
ggplot(prepupapkbr1, aes(x=Gene, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(), stat="identity",
colour="black", # Use black outlines,
size=.8) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal-se, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(.9)) +
xlab("") +
ylab("Relative expression (/rpL32)") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "#888888"))+
ggtitle("Effect of pyriproxyfen on prepupae") +
scale_y_continuous(breaks=seq(0,2,by = 0.1)) +
theme_bw(15)
ggplot(prepupapkbr1, aes(x=Gene, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(), stat="identity",
colour="black", # Use black outlines,
size=.8) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal-se, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(.9)) +
xlab("") +
ylab("Relative expression (/rpL32)") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "#888888"))+
ggtitle("Effect of pyriproxyfen on prepupae") +
scale_y_continuous(breaks=seq(0,2,by = 0.1)) +
theme_bw(1)
ggplot(prepupapkbr1, aes(x=Gene, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(), stat="identity",
colour="black", # Use black outlines,
size=.8) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal-se, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(.9)) +
xlab("") +
ylab("Relative expression (/rpL32)") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "#888888"))+
ggtitle("Effect of pyriproxyfen on prepupae") +
scale_y_continuous(breaks=seq(0,2,by = 0.1)) +
theme_bw(20)
ggplot(prepupapkbr3, aes(x=Gene, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(), stat="identity",
colour="black", # Use black outlines,
size=.8) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal-se, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(.9)) +
xlab("Target gene") +
ylab("Target gene relative expression/rp49") +
scale_fill_manual(name="Treatment", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "#888888"))+
ggtitle("Effect of pyriproxyfen on prepupae") +
scale_y_continuous(breaks=seq(0,2,by = 0.1)) +
theme_bw(20)
ggplot(prepupapkbr3, aes(x=Gene, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(), stat="identity",
colour="black", # Use black outlines,
size=.8) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal-se, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(.9)) +
xlab("") +
ylab("Relative expression/rpL32") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "#888888"))+
ggtitle("Prepupae") +
scale_y_continuous(breaks=seq(0,2,by = 0.1)) +
theme_bw(20)
ggplot(pupapkbr, aes(x=Gene, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(), stat="identity",
colour="black", # Use black outlines,
size=.8) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal-se, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(.9)) +
xlab("") +
ylab("Relative expression/rpL32") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "#888888"))+
ggtitle("Pupae") +
scale_y_continuous(breaks=seq(0,2,by = 0.1)) +
theme_bw(20)
ggplot(pupapkbr1, aes(x=Gene, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(), stat="identity",
colour="black", # Use black outlines,
size=.8) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal-se, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(.9)) +
xlab("") +
ylab("Relative expression/rpL32") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "#888888"))+
ggtitle("Pupae") +
scale_y_continuous(breaks=seq(0,2,by = 0.1)) +
theme_bw(20)
ggplot(pupapkbr1, aes(x=Gene, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(), stat="identity",
colour="black", # Use black outlines,
size=.8) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal-se, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(.9)) +
xlab("") +
ylab("Relative expression/rpL32") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "#888888"))+
ggtitle("Pupae") +
scale_y_continuous(breaks=seq(0,1,by = 0.01)) +
theme_bw(20)
ggplot(pupapkbr2, aes(x=Gene, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(), stat="identity",
colour="black", # Use black outlines,
size=.8) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal-se, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(.9)) +
xlab("") +
ylab("Relative expression/rpL32") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "#888888"))+
ggtitle("Effect of pyriproxyfen on pupae") +
scale_y_continuous(breaks=seq(0,1,by = 0.01)) +
theme_bw(20)
ggplot(pupapkbr3, aes(x=Gene, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(), stat="identity",
colour="black", # Use black outlines,
size=.8) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal-se, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(.9)) +
xlab("") +
ylab("Relative expression/rpL32") +
scale_fill_manual(name="Treatment", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "#888888"))+
ggtitle("Effect of pyriproxyfen on pupae") +
scale_y_continuous(breaks=seq(0,2,by = 0.1)) +
theme_bw(20)
ggplot(pupapkbr3, aes(x=Gene, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(), stat="identity",
colour="black", # Use black outlines,
size=.8) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal-se, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(.9)) +
xlab("") +
ylab("Relative expression/rpL32") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "#888888"))+
ggtitle("Pupae") +
scale_y_continuous(breaks=seq(0,2,by = 0.1)) +
theme_bw(20)
ggplot(pupapkbr3, aes(x=Gene, y=gene.normal, fill=Treatment)) +
geom_bar(position=position_dodge(), stat="identity",
colour="black", # Use black outlines,
size=.8) +      # Thinner lines
geom_errorbar(aes(ymin=gene.normal-se, ymax=gene.normal+se),
size=.8,    # Thinner lines
width=.2,
position=position_dodge(.9)) +
xlab("",labels=c("Pkbr3","Pkbr3 Z2")) +
ylab("Relative expression/rpL32") +
scale_fill_manual(name="", # Legend label, use darker colors
breaks=c("A.Methanol", "B.5mM"),
labels=c("methanol","5mM pyriproxyfen"),
values=c("white", "#888888"))+
ggtitle("Pupae") +
scale_y_continuous(breaks=seq(0,2,by = 0.1)) +
theme_bw(20)
library(caret); library(kernlab); library(e1071)
data(spam)
inTrain<-createDataPartition(y=spam$type, p=0.75, list=FALSE)
training<-spam[inTrain,] #for training
testing<-spam[-inTrain,]
dim(training)
folds<-creaFolds(y=spam$type, k=10, list=true, returnTrain=TRUE)
folds<-createFolds(y=spam$type, k=10, list=true, returnTrain=TRUE)
folds<-createFolds(y=spam$type, k=10, list=TRUE, returnTrain=TRUE)
sapply(folds,length)
folds[[1]][1:10]  # first element of the list, and the first 10 element of the first element
folds<-createTimeSlices(y=tme, initialWindow=20, horizon=10)
folds<-createTimeSlices(y=time, initialWindow=20, horizon=10)
tme<-1:1000
folds<-createTimeSlices(y=tme, initialWindow=20, horizon=10)
names(folds)
install.packages("~/Downloads/phyloch_1.5-3.tgz", repos = NULL)
install.packages("~/Downloads/phyloch_1.5-3.tgz", repos = binary)
install.packages("~/Downloads/phyloch_1.5-3.tgz", repos = both)
install.packages("~/Downloads/phyloch_1.5-3.tgz")
library(phyloch)
library(ips)
library(OutbreakTools)
library(ape)
library(geiger)
library(strap)
install.packages("strap")
library(phyloch)
install.packages("~/Downloads/phyloch_1.5-3.tgz", repos = NULL)
install.packages("~/Downloads/phyloch_1.5-3.tgz")
library(strap)
fileND <- "Apr2015-calibratedA-offset240-250.con.tre"
fileTD<-"TD-A.con.tre"
getwd()
setwd("/Users/isabelle/Dropbox/R-divergence-nov2015/")
fileND <- "Apr2015-calibratedA-offset240-250.con.tre"
fileTD<-"TD-A.con.tre"
ND <- read.nexus(fileND)
TD<-read.nexus(fileTD)
TD<-reorder.phylo(TD)
ND <- reorder.phylo(ND)
TD<-ladderize(TD)
ND<-ladderize(ND)
TDNF<-drop.extinct(TD)
ND<-ladderize(ND)
association<-matrix(ncol=2, nrow=121)
association[,1]<-association[,2]<-TD$tip.label
association<-matrix(ncol=2, nrow=121)
association[,1]<-association[,2]<-ND$tip.label
ND
association<-matrix(ncol=2, nrow=78)
association[,1]<-association[,2]<-ND$tip.label
cophyloplot(TD, ND,,assoc=association,space=100, use.edge.length=TRUE, show.tip.label=FALSE,color="red",rotate=TRUE)
setwd("Dropbox/Manuscripts/divergencetime-VeaandGrimaldi/Manuscript/scientificreports/Nov2015/R/")
data<-read.csv("ages-VeaGrimaldi.csv",header=TRUE)
data
setwd("Dropbox/Manuscripts/divergencetime-VeaandGrimaldi/Manuscript/scientificreports/Nov2015/R/")
setwd("Users/isabelle/Dropbox/Manuscripts/divergencetime-VeaandGrimaldi/Manuscript/scientificreports/Nov2015/R/")
setwd("~/Dropbox/Manuscripts/divergencetime-VeaandGrimaldi/Manuscript/scientificreports/Nov2015/R")
data<-read.csv("ages-VeaGrimaldi.csv",header=TRUE)
data
rootdata<-subset(data, Analysis=="TD-A"|Analysis=="TD-I"|Analysis=="TD-J"|Analysis=="ND-A-offset"|Analysis=="ND-A-noroot"|Analysis=="ND-A-lognormal")
root2data<-subset(rootdata, Lineage=="A.root"|Lineage=="B.Coccomorpha"|Lineage=="C.Neococcoidea")
ggplot(root2data, aes(x =Lineage , y =Posterior.Median.Age, ymin = X95..upper, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=0.5), size = 3, alpha = 0.6) +
geom_point(aes(color = Analysis), position=position_dodge(width=0.5), size = 2) +
theme_bw() + coord_flip()+scale_y_reverse()
library(ape)
library(geiger)
library(phylotools)
A<-read.nexus("ND-A-offsetexp.tre")
B<-read.nexus("ND-B.tre")
C<-read.nexus("ND-C.tre")
D<-read.nexus("ND-D.tre")
E<-read.nexus("ND-E.tre")
F<-read.nexus("ND-F.tre")
G<-read.nexus("ND-G.tre")
H<-read.nexus("ND-H.tre")
I<-read.nexus("ND-I.tre")
J<-read.nexus("ND-J.tre")
K<-read.nexus("ND-K.tre")
setwd("~/Dropbox/_Github_reps/Coccomorpha-divergence-time")
A<-read.nexus("ND-A-offsetexp.tre")
B<-read.nexus("ND-B.tre")
C<-read.nexus("ND-C.tre")
D<-read.nexus("ND-D.tre")
E<-read.nexus("ND-E.tre")
F<-read.nexus("ND-F.tre")
G<-read.nexus("ND-G.tre")
H<-read.nexus("ND-H.tre")
I<-read.nexus("ND-I.tre")
J<-read.nexus("ND-J.tre")
K<-read.nexus("ND-K.tre")
Anoroot<-read.nexus("ND-A-noroot.tre")
Alognormal<-read.nexus("ND-A-lognormal.tre")
age<-read.csv("ages-VeaGrimaldi.csv",header=TRUE)
age<-read.csv("ages-VeaGrimaldi.csv",header=TRUE)
association<-matrix(ncol=2, nrow=78)
association[,1]<-association[,2]<-A$tip.label
ophyloplot(TotalA, A,assoc=association,space=100, use.edge.length=TRUE, show.tip.label=FALSE,color="red",rotate=TRUE)
cophyloplot(TotalA, A,assoc=association,space=100, use.edge.length=TRUE, show.tip.label=FALSE,color="red",rotate=TRUE)
TotalA<-read.nexus("TD-A.con.tre")
TotalB<-read.nexus("TD-B.con.tre")
TotalC<-read.nexus("TD-C.con.tre")
TotalD<-read.nexus("TD-D.con.tre")
TotalE<-read.nexus("TD-E.con.tre")
TotalF<-read.nexus("TD-F.con.tre")
TotalG<-read.nexus("TD-G.con.tre")
TotalH<-read.nexus("TD-H.con.tre")
TotalI<-read.nexus("TD-I.con.tre")
TotalE<-read.nexus("TD-E.con.tre")
TotalF<-read.nexus("TD-F.con.tre")
TotalG<-read.nexus("TD-G.con.tre")
TotalH<-read.nexus("TD-H.con.tre")
TotalI<-read.nexus("TD-I.con.tre")
TotalANF<-drop.extinct(TotalA)
association<-matrix(ncol=2, nrow=78)
association[,1]<-association[,2]<-A$tip.label
cophyloplot(TotalA, A,assoc=association,space=100, use.edge.length=TRUE, show.tip.label=FALSE,color="red",rotate=TRUE)
TotalA<-ladderize(read.nexus("TD-A.con.tre") )
TotalA<-ladderize(read.nexus("TD-A.con.tre"))
TotalA
plot(TotalA)
A<-ladderize(read.nexus("ND-A-offsetexp.tre"))
B<-ladderize(read.nexus("ND-B.tre"))
C<-ladderize(read.nexus("ND-C.tre"))
D<-ladderize(read.nexus("ND-D.tre"))
E<-ladderize(read.nexus("ND-E.tre"))
F<-ladderize(read.nexus("ND-F.tre"))
G<-ladderize(read.nexus("ND-G.tre"))
H<-ladderize(read.nexus("ND-H.tre"))
I<-ladderize(read.nexus("ND-I.tre"))
J<-ladderize(read.nexus("ND-J.tre"))
K<-ladderize(read.nexus("ND-K.tre"))
Anoroot<-ladderize(read.nexus("ND-A-noroot.tre"))
Alognormal<-ladderize(read.nexus("ND-A-lognormal.tre"))
TotalA<-ladderize(read.nexus("TD-A.con.tre"))
TotalB<-ladderize(read.nexus("TD-B.con.tre"))
TotalC<-ladderize(read.nexus("TD-C.con.tre"))
TotalD<-ladderize(read.nexus("TD-D.con.tre"))
TotalE<-ladderize(read.nexus("TD-E.con.tre"))
TotalF<-ladderize(read.nexus("TD-F.con.tre"))
TotalG<-ladderize(read.nexus("TD-G.con.tre"))
TotalH<-ladderize(read.nexus("TD-H.con.tre"))
TotalI<-ladderize(read.nexus("TD-I.con.tre"))
TotalANF<-drop.extinct(TotalA)
age<-read.csv("ages-VeaGrimaldi.csv",header=TRUE)
association<-matrix(ncol=2, nrow=78)
association[,1]<-association[,2]<-A$tip.label
cophyloplot(TotalA, A,assoc=association,space=100, use.edge.length=TRUE, show.tip.label=FALSE,color="red",rotate=TRUE)
rootage<-subset(age, Analysis=="TD-A"|Analysis=="TD-I"|Analysis=="TD-J"|Analysis=="ND-A-offset"|Analysis=="ND-A-noroot"|Analysis=="ND-A-lognormal")
root2age<-subset(rootage, Lineage=="A.root"|Lineage=="B.Coccomorpha"|Lineage=="C.Neococcoidea")
ggplot(root2age, aes(x =Lineage , y =Posterior.Median.Age, ymin = X95..upper, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=0.5), size = 3, alpha = 0.6) +
geom_point(aes(color = Analysis), position=position_dodge(width=0.5), size = 2) +
theme_bw() + coord_flip()+scale_y_reverse()
rootage<-subset(age, Analysis=="TD-A"|Analysis=="TD-H"|Analysis=="TD-I"|Analysis=="ND-A-offset"|Analysis=="ND-A-noroot"|Analysis=="ND-A-lognormal")
root2age<-subset(rootage, Lineage=="A.root"|Lineage=="B.Coccomorpha"|Lineage=="C.Neococcoidea")
ggplot(root2age, aes(x =Lineage , y =Posterior.Median.Age, ymin = X95..upper, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=0.5), size = 3, alpha = 0.6) +
geom_point(aes(color = Analysis), position=position_dodge(width=0.5), size = 2) +
theme_bw() + coord_flip()+scale_y_reverse()
cocoage<-subset(age, Lineage=="A.root"|Lineage=="B.Coccomorpha"|Lineage=="C.Neococcoidea")
coco2age<-subset(cocoage, Analysis=="TD-A"|Analysis=="TD-B"|Analysis=="TD-C"|Analysis=="TD-D"|Analysis=="TD-E"|Analysis=="TD-F"|Analysis=="TD-G"|Analysis=="TD-H"|Analysis=="TD-I")
ggplot(coco2data, aes(x =Lineage , y =Posterior.Median.Age, ymin = X95..upper, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=0.8), size = 3, alpha = 0.6) +
geom_point(aes(color = Analysis), position=position_dodge(width=0.8), size = 2) +
theme_bw() + coord_flip()+scale_y_reverse()
ggplot(coco2age, aes(x =Lineage , y =Posterior.Median.Age, ymin = X95..upper, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=0.8), size = 3, alpha = 0.6) +
geom_point(aes(color = Analysis), position=position_dodge(width=0.8), size = 2) +
theme_bw() + coord_flip()+scale_y_reverse()
ggplot(coco2age, aes(x =Lineage , y =Posterior.Median.Age, ymin = X95..upper, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=0.8), size = 3, alpha = 0.6) +
geom_point(aes(color = Analysis), position=position_dodge(width=0.8), size = 2) +
theme_bw() + coord_flip()+scale_y_reverse()+scale_fill_brewer()
install.packages("RColorBrewer")
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
ggplot(coco2age, aes(x =Lineage , y =Posterior.Median.Age, ymin = X95..upper, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=0.8), size = 3, alpha = 0.6) +
geom_point(aes(color = Analysis), position=position_dodge(width=0.8), size = 2) +
theme_bw() + coord_flip()+scale_y_reverse()+scale_fill_manual(values=cbPalette)
ggplot(coco2age, aes(x =Lineage , y =Posterior.Median.Age, ymin = X95..upper, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=0.8), size = 3, alpha = 0.6) +
geom_point(aes(color = Analysis), position=position_dodge(width=0.8), size = 2) +
theme_bw() + coord_flip()+scale_y_reverse()+scale_fill_manual(values=cbPalette)
library(ggplot2)
ggplot(root2age, aes(x =Lineage , y =Posterior.Median.Age, ymin = X95..upper, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=0.5), size = 3, alpha = 0.6) +
geom_point(aes(color = Analysis), position=position_dodge(width=0.5), size = 2) +
theme_bw() + coord_flip()+scale_y_reverse()
ggplot(coco2age, aes(x =Lineage , y =Posterior.Median.Age, ymin = X95..upper, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=0.8), size = 3, alpha = 0.6) +
geom_point(aes(color = Analysis), position=position_dodge(width=0.8), size = 2) +
theme_bw() + coord_flip()+scale_y_reverse()+scale_fill_manual(values=cbPalette)
ggplot(coco2age, aes(x =Lineage , y =Posterior.Median.Age, ymin = X95..upper, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=0.8), size = 3, alpha = 0.6) +
geom_point(aes(color = Analysis), position=position_dodge(width=0.8), size = 2) +
theme_bw() + coord_flip()+scale_y_reverse()+scale_colour_manual(values=cbPalette)
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7","#000000")
ggplot(coco2age, aes(x =Lineage , y =Posterior.Median.Age, ymin = X95..upper, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=0.8), size = 3, alpha = 0.6) +
geom_point(aes(color = Analysis), position=position_dodge(width=0.8), size = 2) +
theme_bw() + coord_flip()+scale_y_reverse()+scale_colour_manual(values=cbPalette)
ggplot(coco2age, aes(x =Lineage , y =Posterior.Median.Age, ymin = X95..upper, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=0.8), size = 3, alpha = 0.6) +
geom_point(aes(color = Analysis), position=position_dodge(width=0.8), size = 2) +
theme_bw() + coord_flip()+scale_y_reverse()
TDdata<-subset(data, Analysis=="TD-A"|Analysis=="TD-B"|Analysis=="TD-C"|Analysis=="TD-D"|Analysis=="TD-E"|Analysis=="TD-F"|Analysis=="TD-G"|Analysis=="TD-H"|Analysis=="TD-I")
ggplot(TDdata, aes(x =Lineage , y = Posterior.Median.Age, ymin = X95..upper
, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=c(0.8)), size = 1, alpha = 1) +
geom_point(aes(color = Analysis), position=position_dodge(width=c(0.8)), size = 2) +
theme_bw()+coord_flip()++scale_y_reverse()
TDage<-subset(age, Analysis=="TD-A"|Analysis=="TD-B"|Analysis=="TD-C"|Analysis=="TD-D"|Analysis=="TD-E"|Analysis=="TD-F"|Analysis=="TD-G"|Analysis=="TD-H"|Analysis=="TD-I")
ggplot(TDage, aes(x =Lineage , y = Posterior.Median.Age, ymin = X95..upper
, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=c(0.8)), size = 1, alpha = 1) +
geom_point(aes(color = Analysis), position=position_dodge(width=c(0.8)), size = 2) +
theme_bw()+coord_flip()++scale_y_reverse()
TDage<-subset(age, Analysis=="TD-A"|Analysis=="TD-B"|Analysis=="TD-C"|Analysis=="TD-D"|Analysis=="TD-E"|Analysis=="TD-F"|Analysis=="TD-G"|Analysis=="TD-H"|Analysis=="TD-I")
ggplot(TDage, aes(x =Lineage , y = Posterior.Median.Age, ymin = X95..upper
, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=c(0.8)), size = 1, alpha = 1) +
geom_point(aes(color = Analysis), position=position_dodge(width=c(0.8)), size = 2) +
theme_bw()+coord_flip()+scale_y_reverse()
TDage2<-subset(TDage, Lineage=="D.Coccidae"|Lineage=="E.Diaspididae"|Lineage=="F.Kermesidae"|Lineage=="G.Kuwaniidae"|Lineage=="H.Margarodidae"|Lineage=="I.Matsucoccidae"|Lineage=="J.Ortheziidae"|Lineage=="K.Pseudococcidae"|Lineage=="L.Putoidae"|Lineage=="M.Xylococcidae"|)
TDage2<-subset(TDage, Lineage=="D.Coccidae"|Lineage=="E.Diaspididae"|Lineage=="F.Kermesidae"|Lineage=="G.Kuwaniidae"|Lineage=="H.Margarodidae"|Lineage=="I.Matsucoccidae"|Lineage=="J.Ortheziidae"|Lineage=="K.Pseudococcidae"|Lineage=="L.Putoidae"|Lineage=="M.Xylococcidae")
ggplot(TDage, aes(x =Lineage , y = Posterior.Median.Age, ymin = X95..upper
, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=c(0.8)), size = 1, alpha = 1) +
geom_point(aes(color = Analysis), position=position_dodge(width=c(0.8)), size = 2) +
theme_bw()+coord_flip()+scale_y_reverse()
ggplot(TD2age, aes(x =Lineage , y = Posterior.Median.Age, ymin = X95..upper
, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=c(0.8)), size = 1, alpha = 1) +
geom_point(aes(color = Analysis), position=position_dodge(width=c(0.8)), size = 2) +
theme_bw()+coord_flip()+scale_y_reverse()
ggplot(TDage2, aes(x =Lineage , y = Posterior.Median.Age, ymin = X95..upper
, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=c(0.8)), size = 1, alpha = 1) +
geom_point(aes(color = Analysis), position=position_dodge(width=c(0.8)), size = 2) +
theme_bw()+coord_flip()+scale_y_reverse()
ggplot(TDage2, aes(x =Lineage , y = Posterior.Median.Age, ymin = X95..upper
, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=c(1)), size = 1, alpha = 1) +
geom_point(aes(color = Analysis), position=position_dodge(width=c(1)), size = 2) +
theme_bw()+coord_flip()+scale_y_reverse()
ggplot(TDage2, aes(x =Lineage , y = Posterior.Median.Age, ymin = X95..upper
, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=c(0.9)), size = 1, alpha = 1) +
geom_point(aes(color = Analysis), position=position_dodge(width=c(0.9)), size = 2) +
theme_bw()+coord_flip()+scale_y_reverse()
TDNDage<-subset(age, Analysis=="TD-A"|Analysis=="ND-A-offset")
TDNDage2<-subset(TDage, Lineage=="D.Coccidae"|Lineage=="E.Diaspididae"|Lineage=="F.Kermesidae"|Lineage=="G.Kuwaniidae"|Lineage=="H.Margarodidae"|Lineage=="I.Matsucoccidae"|Lineage=="J.Ortheziidae"|Lineage=="K.Pseudococcidae"|Lineage=="L.Putoidae"|Lineage=="M.Xylococcidae")
ggplot(TDNDage2, aes(x =Lineage , y = Posterior.Median.Age, ymin = X95..upper
, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=c(0.9)), size = 1, alpha = 1) +
geom_point(aes(color = Analysis), position=position_dodge(width=c(0.9)), size = 2) +
theme_bw()+coord_flip()+scale_y_reverse()
TDNDage2<-subset(TDNDage, Lineage=="D.Coccidae"|Lineage=="E.Diaspididae"|Lineage=="F.Kermesidae"|Lineage=="G.Kuwaniidae"|Lineage=="H.Margarodidae"|Lineage=="I.Matsucoccidae"|Lineage=="J.Ortheziidae"|Lineage=="K.Pseudococcidae"|Lineage=="L.Putoidae"|Lineage=="M.Xylococcidae")
ggplot(TDNDage2, aes(x =Lineage , y = Posterior.Median.Age, ymin = X95..upper
, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=c(0.9)), size = 1, alpha = 1) +
geom_point(aes(color = Analysis), position=position_dodge(width=c(0.9)), size = 2) +
theme_bw()+coord_flip()+scale_y_reverse()
ggplot(TDNDage2, aes(x =Lineage , y = Posterior.Median.Age, ymin = X95..upper
, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=c(0.9)), size = 2, alpha = 1) +
geom_point(aes(color = Analysis), position=position_dodge(width=c(0.9)), size = 3) +
theme_bw()+coord_flip()+scale_y_reverse()
ggplot(TDNDage2, aes(x =Lineage , y = Posterior.Median.Age, ymin = X95..upper
, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=c(0.9)), size = 2, alpha = 0.6) +
geom_point(aes(color = Analysis), position=position_dodge(width=c(0.9)), size = 3) +
theme_bw()+coord_flip()+scale_y_reverse()
ggplot(TDNDage2, aes(x =Lineage , y = Posterior.Median.Age, ymin = X95..upper
, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=c(0.5)), size = 2, alpha = 0.6) +
geom_point(aes(color = Analysis), position=position_dodge(width=c(0.5)), size = 3) +
theme_bw()+coord_flip()+scale_y_reverse()
TDage<-subset(age, Analysis=="TD-A"|Analysis=="TD-B"|Analysis=="TD-C"|Analysis=="TD-D"|Analysis=="TD-E"|Analysis=="TD-F"|Analysis=="TD-G"|Analysis=="TD-H"|Analysis=="TD-I")
TDage2<-subset(TDage, Lineage=="D.Coccidae"|Lineage=="E.Diaspididae"|Lineage=="F.Kermesidae"|Lineage=="G.Kuwaniidae"|Lineage=="H.Margarodidae"|Lineage=="I.Matsucoccidae"|Lineage=="J.Ortheziidae"|Lineage=="K.Pseudococcidae"|Lineage=="L.Putoidae"|Lineage=="M.Xylococcidae")
ggplot(TDage2, aes(x =Lineage , y = Posterior.Median.Age, ymin = X95..upper
, ymax = X95..lower)) +
geom_linerange(aes(color = Analysis), position=position_dodge(width=c(0.9)), size = 1, alpha = 1) +
geom_point(aes(color = Analysis), position=position_dodge(width=c(0.9)), size = 2) +
theme_bw()+coord_flip()+scale_y_reverse()
ltt.plot(A, lwd=2)  #ND
library(geiger)
ltt.plot(A, lwd=2)  #ND
ltt.lines(TotalANF, lwd=2, col="red") #TD
TotalANF<-drop.extinct(TotalA)
plot(TotalA)
TotalANF<-drop.extinct(TotalA)
TotalA<-ladderize(read.nexus("TD-A.con.tre"))
TotalANF<-drop.extinct(TotalA)
TotalANF<-drop.extinct(TotalA, tol=NULL)
ltt.plot(A, lwd=2)  #ND
ltt.lines(TotalA, lwd=2, col="red") #TD
